{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/bailey/turing/3mod/projects/floristic/client/src/HomeView/HomeView.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useReducer } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport HomeContext from './HomeContext';\nimport { initialState, homeReducer } from './HomeReducer';\nimport Header from './Header/Header';\nimport CardContainer from './CardContainer/CardContainer';\nimport Loading from '../Loading/Loading';\nimport Footer from './Footer/Footer';\nimport Error from '../Error/Error';\nimport { getPlantList, searchPlants } from '../apiCalls';\n\nconst HomeView = ({\n  query,\n  page\n}) => {\n  _s();\n\n  const history = useHistory();\n  const [state, dispatch] = useReducer(homeReducer, initialState);\n  const [cardsOnDisplay, setCardsOnDisplay] = useState(state.plantList);\n  const [favorites, setFavorites] = useState([]);\n  const [pageNumber, setPageNumber] = useState(page);\n  const [search, setSearch] = useState(query);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    retrieveFromStorage();\n  }, [localStorage]);\n  useEffect(() => {\n    saveToStorage();\n  }, [favorites]);\n  useEffect(() => {\n    fetchPlantList();\n  }, [search, page]);\n  useEffect(() => {\n    state.plantList.length === 0 && fetchPlantList();\n\n    if (state.view === 'all') {\n      setCardsOnDisplay(state.plantList);\n    } else {\n      setCardsOnDisplay(favorites);\n    }\n  }, [state.view, state.plantList, favorites]);\n\n  const fetchPlantList = () => {\n    setLoading(true);\n\n    if (!search) {\n      getPlantList(pageNumber).then(data => {\n        handleFetch(data.data);\n        handleLinks(data.links);\n        setLoading(false);\n      }).catch(err => setError(err));\n    } else {\n      searchPlants(search, pageNumber).then(data => {\n        handleFetch(data.data);\n        handleLinks(data.links);\n        setLoading(false);\n      }).catch(err => setError(err));\n    }\n  };\n\n  const handleFetch = data => {\n    const action = {\n      type: 'FETCH_DATA',\n      plantList: data\n    };\n    dispatch(action);\n  };\n\n  const handleLinks = links => {\n    const action = {\n      type: 'FETCH_LINKS',\n      links: links\n    };\n    dispatch(action);\n  };\n\n  const toggleView = () => {\n    const action = {\n      type: 'TOGGLE_VIEW'\n    };\n    dispatch(action);\n  };\n\n  const retrieveFromStorage = () => {\n    const storedFavorites = localStorage.getItem('favorites');\n    const parsedFavorites = JSON.parse(storedFavorites);\n    setFavorites(parsedFavorites);\n    saveToStorage();\n  };\n\n  const saveToStorage = () => {\n    localStorage.clear();\n    let stringifiedFavorites = JSON.stringify(favorites);\n    localStorage.setItem(`favorites`, stringifiedFavorites);\n  };\n\n  const addToFavorites = plant => {\n    setFavorites([...favorites, plant]);\n    saveToStorage();\n  };\n\n  const removeFromFavorites = id => {\n    const favPlants = favorites.filter(plant => plant.id !== id);\n    setFavorites(favPlants);\n    saveToStorage();\n  };\n\n  const updateSearch = queryRequest => {\n    setSearch(queryRequest);\n\n    if (state.view === 'favorites') {}\n  };\n\n  const jumpToPage = page => {\n    setPageNumber(page);\n    fetchPlantList();\n\n    if (search) {\n      history.push(`/search/${search}/${pageNumber}`);\n    } else {\n      history.push(`/${pageNumber}`);\n    }\n  };\n\n  const determineMaxPage = () => {\n    if (state.links.last) {\n      return state.links.last.split('=')[1];\n    } else {\n      return '1';\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(HomeContext.Provider, {\n    value: state,\n    children: !error ? /*#__PURE__*/_jsxDEV(\"section\", {\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        toggleView: toggleView,\n        updateSearch: updateSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this), !loading ? /*#__PURE__*/_jsxDEV(CardContainer, {\n        favorites: favorites,\n        cardsOnDisplay: cardsOnDisplay,\n        addToFavorites: addToFavorites,\n        removeFromFavorites: removeFromFavorites\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 11\n      }, this), state.view === 'all' && /*#__PURE__*/_jsxDEV(Footer, {\n        pageNumber: page,\n        maxPage: determineMaxPage(),\n        jumpToPage: jumpToPage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this) : /*#__PURE__*/_jsxDEV(Error, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n};\n\n_s(HomeView, \"hwOamrBheTVUYgb/dTRTy9u7ZM0=\", false, function () {\n  return [useHistory];\n});\n\n_c = HomeView;\nexport default HomeView;\n\nvar _c;\n\n$RefreshReg$(_c, \"HomeView\");","map":{"version":3,"sources":["/Users/bailey/turing/3mod/projects/floristic/client/src/HomeView/HomeView.js"],"names":["React","useEffect","useState","useReducer","useHistory","HomeContext","initialState","homeReducer","Header","CardContainer","Loading","Footer","Error","getPlantList","searchPlants","HomeView","query","page","history","state","dispatch","cardsOnDisplay","setCardsOnDisplay","plantList","favorites","setFavorites","pageNumber","setPageNumber","search","setSearch","loading","setLoading","error","setError","retrieveFromStorage","localStorage","saveToStorage","fetchPlantList","length","view","then","data","handleFetch","handleLinks","links","catch","err","action","type","toggleView","storedFavorites","getItem","parsedFavorites","JSON","parse","clear","stringifiedFavorites","stringify","setItem","addToFavorites","plant","removeFromFavorites","id","favPlants","filter","updateSearch","queryRequest","jumpToPage","push","determineMaxPage","last","split"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useReducer } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport HomeContext from './HomeContext'\nimport { initialState, homeReducer } from './HomeReducer'\nimport Header from './Header/Header'\nimport CardContainer from './CardContainer/CardContainer'\nimport Loading from '../Loading/Loading'\nimport Footer from './Footer/Footer'\nimport Error from '../Error/Error'\nimport { getPlantList, searchPlants } from '../apiCalls'\n\nconst HomeView = ({ query, page }) => {\n  const history = useHistory()\n  const [state, dispatch] = useReducer(homeReducer, initialState)\n  const [cardsOnDisplay, setCardsOnDisplay] = useState(state.plantList)\n  const [favorites, setFavorites] = useState([])\n  const [pageNumber, setPageNumber] = useState(page)\n  const [search, setSearch] = useState(query)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(null)\n\n  useEffect(() => {\n    retrieveFromStorage()\n  }, [localStorage])\n  \n  useEffect(() => {\n    saveToStorage()\n  }, [favorites])\n  \n  useEffect(() => {\n    fetchPlantList()\n  }, [search, page])\n  \n  useEffect(() => {\n    (state.plantList.length === 0) && fetchPlantList()\n\n    if (state.view === 'all') {\n      setCardsOnDisplay(state.plantList)\n    } else {\n      setCardsOnDisplay(favorites)\n    }\n  }, [state.view, state.plantList, favorites])\n\n  const fetchPlantList = () => {\n    setLoading(true)\n    if (!search) {\n      getPlantList(pageNumber)\n        .then(data => {\n          handleFetch(data.data)\n          handleLinks(data.links)\n          setLoading(false)\n        })\n        .catch(err => setError(err))\n    } else {\n      searchPlants(search, pageNumber)\n        .then(data => {\n          handleFetch(data.data)\n          handleLinks(data.links)\n          setLoading(false)\n        })\n        .catch(err => setError(err))\n    }\n  }\n\n  const handleFetch = (data) => {\n    const action = { type: 'FETCH_DATA', plantList: data }\n    dispatch(action)\n  }\n\n  const handleLinks = (links) => {\n    const action = { type: 'FETCH_LINKS', links: links }\n    dispatch(action)\n  }\n\n  const toggleView = () => {\n    const action = { type: 'TOGGLE_VIEW' }\n    dispatch(action)\n  }\n\n  const retrieveFromStorage = () => {\n    const storedFavorites = localStorage.getItem('favorites')\n    const parsedFavorites = JSON.parse(storedFavorites)\n    setFavorites(parsedFavorites)\n    saveToStorage()\n  }\n\n  const saveToStorage = () => {\n    localStorage.clear()\n    let stringifiedFavorites = JSON.stringify(favorites)\n    localStorage.setItem(`favorites`, stringifiedFavorites)\n  }\n\n  const addToFavorites = (plant) => {\n    setFavorites([...favorites, plant])\n    saveToStorage()\n  }\n\n  const removeFromFavorites = (id) => {\n    const favPlants = favorites.filter(plant => plant.id !== id)\n    setFavorites(favPlants)\n    saveToStorage()\n  }\n\n  const updateSearch = (queryRequest) => {\n    setSearch(queryRequest)\n    \n    if (state.view === 'favorites') {\n\n    }\n  }\n\n  const jumpToPage = (page) => {\n    setPageNumber(page)\n    fetchPlantList()\n\n    if (search) {\n      history.push(`/search/${search}/${pageNumber}`)\n    } else {\n      history.push(`/${pageNumber}`)\n    }\n  }\n\n  const determineMaxPage = () => {\n    if (state.links.last) {\n      return state.links.last.split('=')[1]\n    } else {\n      return '1'\n    }\n  }\n\n  return (\n    <HomeContext.Provider value={state}>\n      {!error ?\n      <section>\n        <Header\n          toggleView={toggleView}\n          updateSearch={updateSearch}\n        />\n        {!loading ?\n          <CardContainer\n            favorites={favorites}\n            cardsOnDisplay={cardsOnDisplay}\n            addToFavorites={addToFavorites}\n            removeFromFavorites={removeFromFavorites}\n          /> :\n          <Loading />\n        }\n        {state.view === 'all' && \n          <Footer\n            pageNumber={page}\n            maxPage={determineMaxPage()} \n            jumpToPage={jumpToPage} \n          />\n        }\n      </section> :\n      <Error />\n    }\n    </HomeContext.Provider>\n  )\n}\n\nexport default HomeView"]},"metadata":{},"sourceType":"module"}